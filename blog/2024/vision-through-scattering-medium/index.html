<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Vision in Degraded Visibility Conditions | George Tang </title> <meta name="author" content="George Tang"> <meta name="description" content="Can we remove weather effects from images? Can we do the opposite?"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/mit.png?0f73a156b14a8cd1002c97eef4fac144"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gtangg12.github.io/blog/2024/vision-through-scattering-medium/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">George</span> Tang </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Vision in Degraded Visibility Conditions</h1> <p class="post-meta"> October 18, 2024 </p> <p class="post-tags"> <a href="/blog/2024"> <i class="fa-solid fa-calendar fa-sm"></i> 2024 </a>   ·   <a href="/blog/tag/computer-vision"> <i class="fa-solid fa-hashtag fa-sm"></i> computer-vision</a>   <a href="/blog/tag/machine-learning"> <i class="fa-solid fa-hashtag fa-sm"></i> machine-learning</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>I have been working on vision in degraded visibility conditions (fog, rain, snow, and nighttime) for a long time. Over the years I have made progress on many facets the problem, and many things in the field of vision has also changed along the way. I will outline some interesting aspects I’ve encountered and constructed in this post.</p> <h2 id="introduction-to-atmospheric-scattering">Introduction to Atmospheric Scattering</h2> <p>To motivate the problem, consider the scenario where you are given a single foggy RGB image and you want to obtain the defogged image. Before we delve into the details, let’s first understand the physics of fog. Fog is a weather phenomenon that occurs when the air is saturated with water vapor. The water droplets in the air scatter light (a phenomenon known as Mie scattering), which reduces the contrast and visibility of objects in the scene. Let \(L\) be the luminance of an object under monochromatic light, \(L_0\) the luminance at zero distance, \(\beta\) Mie scattering parameter, and \(\alpha\) background luminance (airlight). Both Koschmieder (1924) [1] and Duntley (1948) [2] show the scattering of light is modeled by the following equation (Atmospheric Scattering Model):</p> \[L = L_0 e^{-\beta d} + \alpha (1 - e^{-\beta d})\] <p>where \(d\) is the distance between the observer and the object. This model is applicable to visibility degredation through a scattering medium in general, and not limited to fog.</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/asm-480.webp 480w,/assets/img/blog/vision-in-fog/asm-800.webp 800w,/assets/img/blog/vision-in-fog/asm-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/asm.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>A short note, humans are trichromatic and have cones for short, medium, and long wavelengths that correspond to our perception of blue, green, and red primary colors (1931 CIE color matching). The luminance of each channel, \(y\) is computed by integrated the respective color matching function against the irradiance, \(E\), over all wavelengths.</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/cie-480.webp 480w,/assets/img/blog/vision-in-fog/cie-800.webp 800w,/assets/img/blog/vision-in-fog/cie-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/cie.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Without scattering, the luminance of each channel is given by</p> \[L_{y} = \int_{0}^{\infty} y(\lambda) E(\lambda) d\lambda\] <p>Mie scattering is independent of wavelengths, that is with scattering, the luminance of each channel is given by the Atmospheric Scattering Model as</p> \[L_{y} = \int_{0}^{\infty} y(\lambda) e^{-\beta d} E(\lambda) d\lambda + \alpha y(\lambda) (1 - e^{-\beta d}) E(\lambda) d\lambda\] <p>From an imaging perspective, for each channel we have</p> \[I(x) = J(x) t(x) + \alpha(1 - t(x))\] <p>where \(I(x)\) is the observed luminance at pixel \(x\), \(J(x)\) is the scene luminance, \(t(x) = e^{-\beta d(x)}\) is the transmission map, and \(d(x)\) the depth map. With some algebra, we can see to estimate the scene radiance \(J(x)\) we need to estimate the transmission map \(t(x)\).</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/asm_examples-480.webp 480w,/assets/img/blog/vision-in-fog/asm_examples-800.webp 800w,/assets/img/blog/vision-in-fog/asm_examples-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/asm_examples.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Two early works, DehazeNet [3] and Dark Channel Prior [4], respectively estimated the transmission map directly in an end-to-end manner using a ConvNet and using the Dark Channel Prior. Once we have the transmission map, as in DehazeNet, \(\alpha\) can be estimated as</p> \[\alpha = \max_{y, x \in t(x) &lt; t_0} I(x)\] <p>where \(t_0\) is a tunable parameter.</p> <h2 id="visibility-distance-estimation">Visibility Distance Estimation</h2> <p>While at Nvidia Self Driving, I worked on operational domain verification for autonomous vehicles. One of the tasks was to determine the <em>meteorological</em> visibility distance, which influenced the decisions made by the perception stack. We can rearrange the Atmospheric scattering model as follows</p> \[\frac{L - \alpha}{\alpha} = \left( \frac{L_{0} - \alpha}{\alpha} \right)e^{-\beta d}\] <p>or equivalently</p> \[C = C_{0}e^{-\beta d}\] <p>where \(C\) is defined as the visual contrast. The meteorological visibility distance is defined as the distance at which the visual contrast is reduced to a certain threshold, usually 0.05 of a black object (\(L_{0} = 0\)), which is approximately</p> \[d_{m} = \frac{\ln(0.05)}{\beta}\] <p>It is important to note visibility distance degredation is a global effect. This means local effects by lamppost glare, puddle reflections, vehicle spray do not contribute to the visibility distance. This does not mean we do not consider them; on the contrary, our model must learn how to recongize and ignore local effects. The team decided to train a CNN to regress visibility distance from synthetic data, as real images in degraded conditions were sparse due to collection bias.</p> <p>If the only condition considered was fog, the solution would be straightforwards. In the real world, however, degraded visibility is usually observed with other weather conditions such as rain, sleet, or snow, as shown below</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/visibility_conditions-480.webp 480w,/assets/img/blog/vision-in-fog/visibility_conditions-800.webp 800w,/assets/img/blog/vision-in-fog/visibility_conditions-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/visibility_conditions.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>The team decided to generate data using DriveSim, Nvidia’s simulation engine, with global effects e.g. fog, rain, snow, sleet, or nighttime as well as local effects. Some examples of global and local effects at a fixed visibility degredation are shown below</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/visibility_sim-480.webp 480w,/assets/img/blog/vision-in-fog/visibility_sim-800.webp 800w,/assets/img/blog/vision-in-fog/visibility_sim-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/visibility_sim.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>To get the ground truth visibility from global effect parameters, we setup an interface with simple track scene with an black object. The interface would binary search for where the user can detect the object</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/visibility_sim_interface-480.webp 480w,/assets/img/blog/vision-in-fog/visibility_sim_interface-800.webp 800w,/assets/img/blog/vision-in-fog/visibility_sim_interface-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/visibility_sim_interface.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>One issue however, was there is a large sim2real gap. Forunately, other projects had shown mixing real data with DriveSim data resulted the model generalizing well to real world data features derived from DriveSim data. We decided to mix the DriveSim data with real visibility degraded data generated using the Atmospheric Scattering Model and estimating the depth maps via monocular depth estimation.</p> <p>We show two examples of real foggy images collected from real life and a visibility degraded image generated from a real clear image below</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/visibility_fog-480.webp 480w,/assets/img/blog/vision-in-fog/visibility_fog-800.webp 800w,/assets/img/blog/vision-in-fog/visibility_fog-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/visibility_fog.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>The atmospheric model is quite powerful and can produce varying levels of degredation</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/visibility_fog_levels-480.webp 480w,/assets/img/blog/vision-in-fog/visibility_fog_levels-800.webp 800w,/assets/img/blog/vision-in-fog/visibility_fog_levels-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/visibility_fog_levels.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Generated data can also be fed into a general data augmentation engine to produce different scenarios such as sand and dust storms</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/visibility_diverse-480.webp 480w,/assets/img/blog/vision-in-fog/visibility_diverse-800.webp 800w,/assets/img/blog/vision-in-fog/visibility_diverse-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/visibility_diverse.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Verification with real data collected by test drives produced approximately reasonable results. In practice, the regressed visibility distance is classified into bins, and the car correspondingly switches autonomy levels based on the designated visibility bin.</p> <h2 id="in-the-generative-model-era">In the Generative Model Era</h2> <p>The advent of generative diffusion processes opened up new avenues to the data augmentation aspect of the problem, specifically domain translation for autonomous vehicle dataset augmentation. Given a biased dataset of images collected under good driving conditions, can we construct foggy, rainy, snowy, and nighttime counterparts for each image, preserving structure and semantics but changing weather? Previous approaches such as CycleGAN and MUNIT have touched on this problem, but diffusion models provide an unprecented level of realism and control over the generated images.</p> <p>I constructed a language model-based augmentation agent that performs rejection sampling of InstructPix2Pix [5]. Given an input image, the language model would propose edits that InstructPix2Pix carried out. InstructPix2Pix often fails to generate edits or corrupts the image— edited images below an LPIPs threshold are removed. The agent then proceeds recursively to the accepted edits. Optionally as a final step, the depth map of the input image is estimated and visibility degradation is applied using an atmospheric scattering model. The pipeline is illustrated below</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/augmentation_agent_pipeline-480.webp 480w,/assets/img/blog/vision-in-fog/augmentation_agent_pipeline-800.webp 800w,/assets/img/blog/vision-in-fog/augmentation_agent_pipeline-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/augmentation_agent_pipeline.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 75%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>Here are some results of the agent, which is able to support a diverse array of quality edits far beyond what previous methods could achieve</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/augmentation_agent-480.webp 480w,/assets/img/blog/vision-in-fog/augmentation_agent-800.webp 800w,/assets/img/blog/vision-in-fog/augmentation_agent-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/augmentation_agent.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 90%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>In general, the performance is decent but there are several issues with InstructPix2Pix:</p> <ul> <li>high corruption rate</li> <li>edit quality dependent on finetuning data</li> <li>does not support compositional domain translation e.g. a clear image is transformed to have a hybrid of weather conditions</li> </ul> <p>where the last point is particularly important.</p> <p>This led me to an alternative method: Schrodinger Bridge-based methods [6], [7], which are well grounded in theory and result in minimal corruption. They only rely on the diffusion model \(p_{\phi}(x)\) accurately modeling the source and target domain image distributions, compared to being finetuned on edits. In the case of [7] are defined as the diffusion model image distribution conditioned on keywords describing the source and target domains \(p_{\phi}(x, y_{\text{src}})\), \(p_{\phi}(x, y_{\text{tgt}})\). Given this setup, [7] provides a translation gradient to optimize the image \(x\) from the source to the target distribution</p> \[\nabla_x \mathcal{L}(x) \propto \mathbb{E}_{t, \epsilon}\left[ \epsilon_{\phi}(x_t, y_{\text{src}}, t) - \epsilon_{\text{tgt}}(x_t, y_{\phi}, t) \right]\] <p>where \(x_t\) denotes the noised image and \(\epsilon\) denotes the learned score function for \(p_{\phi}(x)\). Below are some videos of domain translation in action for snow, nighttime, and rain. The edits are more realistic than InstructPix2Pix since Schrodinger Bridge-based methods are based on a notion of optimal transport between the conditional diffusion distributions.</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/augmentation_sds-480.webp 480w,/assets/img/blog/vision-in-fog/augmentation_sds-800.webp 800w,/assets/img/blog/vision-in-fog/augmentation_sds-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/augmentation_sds.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 90%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>We found that simply following a weighted combination of translation gradients can achieve compositional domain translation. The weights, however, may vary for different domains. As an example, suppose we are translating to both domains A and B.Tthe translation gradient for domain A may need to be weighted higher than the translation gradient for domain B for the final image to have A and B equally present. We propose to translate the image to domains A and B separately. Then, we dynamically adjust the weights during compositional domain translation optimization using an image similarity model such as CLIP by comparing the similarity of the currently optimized image to the separately translated images. Instead of weight adjustment, assuming there is a large number of optimization steps, each step we can step towards one domain, adjusting the target as needed. Below we show some examples of interpolations between night and snow with different weights.</p> <div style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/blog/vision-in-fog/augmentation_sds_compositional-480.webp 480w,/assets/img/blog/vision-in-fog/augmentation_sds_compositional-800.webp 800w,/assets/img/blog/vision-in-fog/augmentation_sds_compositional-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/blog/vision-in-fog/augmentation_sds_compositional.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" style=" max-width: 90%; " loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>And so far that’s it. Thanks for reading and stay tuned for more updates on vision in degraded visibility conditions!</p> <h2 id="references">References</h2> <p>[1] Koschmieder, H., Theorie der horizontalen Sichtweite. Beitr. Phys. Atmos. 12, 33-58 (1906) <br> [2] Duntley, S. Q., The visibility of distant objects. J Opt Soc Am. (1948) <br> [3] DehazeNet: An End-to-End System for Single Image Haze Removal, 2016 <br> [4] Single Image Haze Removal Using Dark Channel Prior, 2009 <br> [5] InstructPix2Pix: Learning to Follow Image Editing Instructions, 2022 <br> [6] Dual Diffusion Implicit Bridges for Image-to-Image Translation, 2023 <br> [7] Rethinking Score Distillation as a Bridge Between Image Distributions, 2024</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 George Tang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Last updated: November 21, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?fcfacfb8c6281f5e68d5a7d348186eb1"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> </body> </html>